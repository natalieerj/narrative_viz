<html>
  <head>
    <title>Drug Usage by Age</title>
    <script src="https://d3js.org/d3.v4.js"></script>
  </head>

  <body>
    <h1>Drug and Alcohol Usage by Age</h1>
       <div id="controls">
          <span class="type">
            Type of drug:
            <select class="type" name="type"></select>
          </span>
    </div>
    
    <svg width=300 height=300>
    </svg>
    <script>
        labels = ['alcohol', 'marijuana', 'cocaine', 'crack', 'heroin', 'hallucinogen', 'inhalant', 'painreleiver', 'oxycontin', 'tranquilizer', 'stimulant', 'meth', 'sedative']
     d3.select('select.type')
        .on('change', () => update(data))
        .selectAll('option')
        .data(labels)
        .enter()
        .append('option')
        .attr('value', d => d)
        .text(d => d)

      // initialize
        d3.select('select.type').property('value', 'alcohol')
 
       // read current selections
        let vars = d3.select('select.type').property('value')

      data = d3.csv("drug-age-usage.csv", function(data) {
      //   return {
      //     Variables: d.Variables,
      //     age12: d.age12,
      //     age13: d.age13,
      //     age14: d.age14,
      //     age15: d.age15,
      //     age16: d.age16,
      //     age17: d.age17,
      //     age18: d.age18,
      //     age19: d.age19,
      //     age20: d.age20,
      //     age21: d.age21,
      //     age2223: d.age2223,
      //     age2425: d.age2425,
      //     age3034: d.age3034,
      //     age3549: d.age3549,
      //     age5064: d.age5064,
      //     age65: d.age65
      // } 

        consol.log(data);


     //   data = d3.csv('drug-age-usage.csv')
        labels = ['alcohol', 'marijuana', 'cocaine', 'crack', 'heroin', 'hallucinogen', 'inhalant', 'painreleiver', 'oxycontin', 'tranquilizer', 'stimulant', 'meth', 'sedative']
        d3.select('select.type')
              .on('change', () => updateChart(data))
              .selectAll('option')
              .data(labels)
              .enter()
              .append('option')
              .attr('value', d => d)
              .text(d => d)
        d3.select('select.type').property('value', 'alcohol')
      
        vars = d3.select('select.type').property('value')
    
        temp = data.filter(function(d){ return d.Variable == vars})
    
        circ = Array(100)

        x = d3.max(temp, function(d) { return d.age12; })

        colors = []

        for (let i = 0; i < x; i++) {
            colors = colors.concat("red");
        }  


        d3.select("svg").append("g").attr("transform", "translate(10,10)").selectAll("circle").data(circ).enter().append("circle")
          .attr("cx", function(d,i) {
              x = (15 * Math.floor(i/10));      
              return x})
          .attr("cy", function(d,i) {
                y = 15 * (i%10)
                return y})
          .attr("r", 5)
          .style("fill", function(d,i) {return colors[i]})

        function updateChart(newdata) {
          vars = d3.select('select.type').property('value')
          temp = newdata.filter(function(d){ return d.Variable == vars})
          colors = []
          x = d3.max(temp, function(d) { return d.age12; })
          for (let i = 0; i < x; i++) {
              colors = colors.concat("red");
          }
          d3.select("svg").select("g").selectAll("circle").style("fill",  function(d,i) {return colors[i]})
        }
      //   circ = Array(100)
      // xx = 4

// colors = []

// for (let i = 0; i < 4; i++) {
//     colors = colors.concat("red");
// }
  
      //   colors = ['red', 'red', 'red', 'red']
        
      //   d3.select("svg").append("g").attr("transform", "translate(10,10)").selectAll("circle").data(circ).enter().append("circle")
      //   .attr("cx", function(d,i) {
      //       x = (15 * Math.floor(i/10));      
      //       return x})
      //   .attr("cy", function(d,i) {
      //       y = 15 * (i%10)
      //       return y})
      //   .attr("r", 5)
      //   .style("fill", function(d,i) {return colors[i]})
      // }
    });
    </script>
  </body>
</html>

<!--   dat = Array(10)
var x = 100 + (50* Math.floor(i/10));           
var y = 50 * (i%10) + 20 ;

d3.select("svg").append("g").attr("transform", "translate(50,50)").selectAll("circle").data(dat).enter().append("circle")
.attr("cx", 50)
.attr("cy", function(d,i) {return i* 10})
.attr("r", 5) -->
